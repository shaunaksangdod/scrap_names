import os
import re

# regex to find txt file
re1='.*?'	# Non-greedy match on filler
re2='(\\.)'	# Any Single Character 1
re3='(txt)'	# Word 1
rg = re.compile(re1 + re2 + re3, re.IGNORECASE | re.DOTALL)

# regex for email
email_re1='\S+@\S+'
email_rg = re.compile(email_re1,re.IGNORECASE|re.DOTALL)

# names to be removed
name_list = [ 'Anne Roth','Brendan Weber','Emily Foley','Allison Wolf','Meredith McCarthy','Greg Hartman',"Todd O'Brien",
             'Brad Snyder','Seth Gallagher','Jill Becker','Jamal Jefferson','Darnell Washington','Latoya Banks',
             'Lakisha Mosley','Keisha Jackson','Tanisha Charles','Tyrone Dorsey','Tamika Rivers','Tremayne Booker',
             'Jermaine Gaines']

for dir in os.listdir('.'):
    if dir == 'Craiglist':
        for subdir in os.listdir(dir):
            for files in os.listdir(dir+'/'+subdir):
                txt = files
                m = rg.search(txt)
                # if it's a text file, parse
                if m:
                    # parse file here
                    with open(os.path.join(dir,subdir,files),'r',errors='ignore') as f:
                        lines = [x for x in f.readlines()]
                        for i,line in enumerate(lines):
                            # remove name
                            for name in name_list:
                                name_split = name.split(' ')
                                if name_split[0].lower() in line.lower() or name_split[1].lower() in line.lower():
                                    line = line.replace(name_split[0],'###').replace(name_split[1],'###')
                            # remove email
                            email_m = email_rg.search(line)
                            if email_m:
                                line = line.replace(email_m.group(),'###@##.com')
                            lines[i] = line + '\n'
                        # create new files
                        if not os.path.exists(os.path.join('./updated_craiglist', subdir)):
                            os.makedirs(os.path.join('./updated_craiglist', subdir))
                        with open(os.path.join('./updated_craiglist', subdir, files),'w',errors='ignore')as f:
                            f.writelines(lines)



